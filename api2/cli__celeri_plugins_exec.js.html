---
layout: page
hide-title: true
title: "Source: cli/_celeri/plugins/exec.js"
---

<ul class="nav nav-tabs">
    <li><a href="index.html">Overview</a></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Modules<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="module-radic.html">radic</a></li><li><a href="module-radic_cli.html">radic/cli</a></li><li><a href="module-radic_config.html">radic/config</a></li><li><a href="module-radic_db.html">radic/db</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Classes<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="module-radic_config-Config.html">Config</a></li><li><a href="module-radic_db-DB.html">DB</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Global<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="global.html#buffer">buffer</a></li><li><a href="global.html#columns">columns</a></li><li><a href="global.html#cursor">cursor</a></li><li><a href="global.html#inputPrefix">inputPrefix</a></li><li><a href="global.html#insertText">insertText</a></li><li><a href="global.html#next">next</a></li><li><a href="global.html#replaceLine">replaceLine</a></li><li><a href="global.html#rows">rows</a></li><li><a href="global.html#size">size</a></li><li><a href="global.html#spliceLine">spliceLine</a></li></ul></li>
</ul>

<div id="main">
    



    
            {% highlight javascript %}
            var spawn = require('child_process').spawn;

exports.plugin = function(cli) {

    /**
     * goal = dead simple and painless. 
     */
     
    cli.exec = function(command, args, ops, callback) {

        if(typeof args == 'function') {
            callback = args;
            args = [];
            ops = {};
        } else 
        if(!(args instanceof Array)) {
            callback = ops;
            ops = args;
            args = [];
        }
        
        
    
        if(typeof ops == 'function') {
            callback = ops;
            ops = {};
        }
        
        //no callbacks? THEY MUST EXIST!!!!
        if(!callback) callback = ops.callback || ops;
        
        var callbacks = {};
        
        if(typeof callback != 'function') {
            callbacks = callback;
        }
        
        if(!callbacks.error) callbacks.error = function(){};
        if(!callbacks.exit) callbacks.exit = function(){};
        if(!callbacks.data) callbacks.data = function(){};
        
        
        var procOps = {
            cwd: ops.cwd,
            env: ops.env,
            customFds: ops.customFds
        };
        
        
        var proc = spawn(command, ops.args || args, procOps), errors = [], buffer = [];
        
        proc.stdout.on('data', function(data) {
            buffer.push(data);
            
            callbacks.data(data);
        });
        
        proc.stderr.on('data', function(data) {
            errors.push(data);
            
            callbacks.error(data);
        });
        
        proc.on('exit', function(code) {
            
            if(typeof callback == 'function')  {
                callback(errors.length ? errors.join(' ') : false, buffer.length ? buffer.join(' ') : false);
            } else
            if(callbacks.exit) {
                callbacks.exit(code);
            }
        });
        
    }
}
            {% endhighlight %}





</div>


<style type="text/css">

.ancestors { color: #999; }
.ancestors a
{
    color: #999 !important;
    text-decoration: none;
}

.clear
{
    clear: both;
}

.important
{
    font-weight: bold;
    color: #950B02;
}

.yes-def {
    text-indent: -1000px;
}

.type-signature {
    color: #aaa;
}

.name, .signature {
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
}

.details { margin-top: 14px; border-left: 2px solid #DDD; }
.details dt { width: 120px; float: left; padding-left: 10px;  padding-top: 6px; }
.details dd { margin-left: 70px; }
.details ul { margin: 0; }
.details ul { list-style-type: none; }
.details li { margin-left: 30px; padding-top: 6px; }
.details pre.prettyprint { margin: 0 }
.details .object-value { padding-top: 0; }


.params, .props
{
    border-spacing: 0;
    border: 0;
    border-collapse: collapse;
}

.params .name, .props .name, .name code {
    color: #4D4E53;
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
    font-size: 100%;
}

.params td, .params th, .props td, .props th
{
    border: 1px solid #ddd;
    margin: 0px;
    text-align: left;
    vertical-align: top;
    padding: 4px 6px;
    display: table-cell;
}

.params thead tr, .props thead tr
{
    background-color: #ddd;
    font-weight: bold;
}

.params .params thead tr, .props .props thead tr
{
    background-color: #fff;
    font-weight: bold;
}

.params th, .props th { border-right: 1px solid #aaa; }
.params thead .last, .props thead .last { border-right: 1px solid #ddd; }

.params td.description > p:first-child
{
    margin-top: 0;
    padding-top: 0;
}

.params td.description > p:last-child
{
    margin-bottom: 0;
    padding-bottom: 0;
}
</style>
