---
layout: page
hide-title: true
title: "Source: cli/_celeri/plugins/help.js"
---

<ul class="nav nav-tabs">
    <li><a href="index.html">Overview</a></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Modules<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="module-radic.html">radic</a></li><li><a href="module-radic_cli.html">radic/cli</a></li><li><a href="module-radic_config.html">radic/config</a></li><li><a href="module-radic_db.html">radic/db</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Classes<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="module-radic_config-Config.html">Config</a></li><li><a href="module-radic_db-DB.html">DB</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Global<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="global.html#buffer">buffer</a></li><li><a href="global.html#columns">columns</a></li><li><a href="global.html#cursor">cursor</a></li><li><a href="global.html#inputPrefix">inputPrefix</a></li><li><a href="global.html#insertText">insertText</a></li><li><a href="global.html#next">next</a></li><li><a href="global.html#replaceLine">replaceLine</a></li><li><a href="global.html#rows">rows</a></li><li><a href="global.html#size">size</a></li><li><a href="global.html#spliceLine">spliceLine</a></li></ul></li>
</ul>

<div id="main">
    



    
            {% highlight javascript %}
            var fs = require('fs');

function capitalizeFirst(str) {
    return str.substr(0,1).toUpperCase() + str.substr(1);
}

var helpMenu = function(cli) {

    var usage,
    desc,
    items = {},
    used = {},
    children = {};


    var self = {

        /**
         * description
         */

        description: function(value) {

            desc = value;

        },

        /**
         */

        usage: function(value) {

            usage = value;

        },



        /**
         * adds a help item
         */

        add: function(category, name, desc) {

            if(used[name]) return;
            used[name]= 1;

            if(!items[category]) items[category] = [];

           items[category].push({
               name: name,
               desc: desc
           });
        },

        /**
         */

        child: function(name) {
            return children[name] || (children[name] = helpMenu(cli));
        },

        /**
         */

        print: function() {

            //line break
            console.log();

            if(desc) {
                console.log('%s\n'.bold, desc);
            }

            if(usage) console.log('%s: %s\n', 'Usage'.bold, usage);

            for(var category in items) {

                console.log('%s:'.bold, capitalizeFirst(category));

                var ops = {
                    ellipsis: true,
                    columns: {
                        name: 20,
                        desc: 70
                    },
                    pad: {
                        left: 2
                    }
                };



                cli.table(items[category], ops);
                console.log();
            }
        }
    };

    return self;
}




exports.plugin = function(cli) {

    var help = helpMenu(cli);


    cli.addHelp = function(ops) {


        //fix the usage so it's turned from command :op to command [op]
        if(ops.usage)
        ops.usage = ops.usage.
        replace(/\:(\w+)/g,'[$1]').
        replace(/OR/g,'OR'.bold);

        help.add(ops.category || 'options', ops.name, ops.description || ops.desc);

        //set the usage for the child help item
        var childHelp = help.child(ops.name);

        childHelp.usage(ops.usage);
        childHelp.description(ops.description);


        var k;


        if(ops.defaults) {
            for(var op in ops.optional) {

                k = op;

                if(ops.defaults[op]) {
                    k = k + "=" + ops.defaults[k];
                }


                childHelp.add('Optional Flags', "--" + k, ops.optional[op]);

            }
        }

        return cli;
    }

    cli.usage = help.usage;


    help.usage('[command] --arg=value --arg2')


    cli.help = function() {

        help.print();

    }

    cli.commandHelp = function(data, next) {


        //intercept commands that are :command help
        if(this.path.segments.length > 1 &amp;&amp; this.path.segments[1].value == 'help') {

            help.child(this.path.segments[0].value).print();

            return;
        }

        next();
    }

    cli.option('help', cli.help).
    option(':command help OR **', cli.commandHelp);

    cli.addHelp({
        category: 'help',
        name: '[cmd] help',
        description: 'Show command help menu'
    });

    cli.addHelp({
        category: 'help',
        name: 'help',
        description: 'Show help menu'
    });
}

            {% endhighlight %}





</div>


<style type="text/css">

.ancestors { color: #999; }
.ancestors a
{
    color: #999 !important;
    text-decoration: none;
}

.clear
{
    clear: both;
}

.important
{
    font-weight: bold;
    color: #950B02;
}

.yes-def {
    text-indent: -1000px;
}

.type-signature {
    color: #aaa;
}

.name, .signature {
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
}

.details { margin-top: 14px; border-left: 2px solid #DDD; }
.details dt { width: 120px; float: left; padding-left: 10px;  padding-top: 6px; }
.details dd { margin-left: 70px; }
.details ul { margin: 0; }
.details ul { list-style-type: none; }
.details li { margin-left: 30px; padding-top: 6px; }
.details pre.prettyprint { margin: 0 }
.details .object-value { padding-top: 0; }


.params, .props
{
    border-spacing: 0;
    border: 0;
    border-collapse: collapse;
}

.params .name, .props .name, .name code {
    color: #4D4E53;
    font-family: Consolas, Monaco, 'Andale Mono', monospace;
    font-size: 100%;
}

.params td, .params th, .props td, .props th
{
    border: 1px solid #ddd;
    margin: 0px;
    text-align: left;
    vertical-align: top;
    padding: 4px 6px;
    display: table-cell;
}

.params thead tr, .props thead tr
{
    background-color: #ddd;
    font-weight: bold;
}

.params .params thead tr, .props .props thead tr
{
    background-color: #fff;
    font-weight: bold;
}

.params th, .props th { border-right: 1px solid #aaa; }
.params thead .last, .props thead .last { border-right: 1px solid #ddd; }

.params td.description > p:first-child
{
    margin-top: 0;
    padding-top: 0;
}

.params td.description > p:last-child
{
    margin-bottom: 0;
    padding-bottom: 0;
}
</style>
