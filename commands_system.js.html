---
layout: page
title: Node Radic
minify_content: false
navigation:
  - name: Home
    link: /
    icon: fa fa-home
  - name: Overview
    link: /node-radic
    icon: fa fa-dashboard
  - name: Coverage
    link: /node-radic/coverage
    icon: fa fa-code
  - name: Tutorials
    link: null
    icon: fa fa-info
    children:
      - name: General
        link: /node-radic/tutorials
      - name: "Cli & Commands"
        link: /node-radic/tutorials/cli.html
      - name: "Config & DB"
        link: /node-radic/tutorials/config-db.html
      - name: Binwraps
        link: /node-radic/tutorials/binwraps.html
  - name: Modules
    link: "#"
    icon: fa fa-mortar-board
    children:
      - name: radic
        link: /node-radic/module-radic.html
  - name: Externals
    link: "#"
    icon: fa fa-mortar-board
    children:
      - name: async
        link: /node-radic/external-async.external_async.html
      - name: lodash
        link: /node-radic/external-lodash.html
      - name: tmp
        link: /node-radic/external-tmp.html
      - name: string
        link: /node-radic/underscore.external_string.html
  - name: Classes
    link: "#"
    icon: fa fa-mortar-board
    children:
      - name: App
        link: /node-radic/App.html
      - name: Config
        link: /node-radic/Config.html
      - name: DB
        link: /node-radic/DB.html
      - name: Model
        link: /node-radic/Model.html
      - name: Table
        link: /node-radic/Table.html
  - name: Events
    link: "#"
    icon: fa fa-mortar-board
    children:
      - name: "create:error"
        link: "/node-radic/Model.html#event:create:error"
      - name: "create:invalid"
        link: "/node-radic/Model.html#event:create:invalid"
      - name: create
        link: "/node-radic/Model.html#event:create"
  - name: Namespaces
    link: "#"
    icon: fa fa-mortar-board
    children:
      - name: binwraps
        link: /node-radic/binwraps.html
      - name: cli
        link: /node-radic/cli.html
      - name: git
        link: /node-radic/git.html
      - name: google
        link: /node-radic/google.html
      - name: net
        link: /node-radic/net.html
      - name: sh
        link: /node-radic/sh.html
      - name: util
        link: /node-radic/util.html

---

<link type="text/css" rel="stylesheet" href="styles/jsdoc-radic.css">


<ul class="nav nav-tabs hide">
    <li><a href="index.html">Overview</a></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Modules<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="module-radic.html">radic</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Externals<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="external-async.external_async.html">async</a></li><li><a href="external-lodash.html">lodash</a></li><li><a href="external-tmp.html">tmp</a></li><li><a href="underscore.external_string.html">string</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Classes<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="App.html">App</a></li><li><a href="Config.html">Config</a></li><li><a href="DB.html">DB</a></li><li><a href="Model.html">Model</a></li><li><a href="Table.html">Table</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Events<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="Model.html#event:create:error">create:error</a></li><li><a href="Model.html#event:create:invalid">create:invalid</a></li><li><a href="Model.html#event:create">create</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Namespaces<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="binwraps.html">binwraps</a></li><li><a href="cli.html">cli</a></li><li><a href="git.html">git</a></li><li><a href="google.html">google</a></li><li><a href="net.html">net</a></li><li><a href="sh.html">sh</a></li><li><a href="util.html">util</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Global<i class="fa fa-angle-down"></i></a><ul class="dropdown-menu" role="menu"><li><a href="global.html#app">app</a></li></ul></li>
</ul>

<div id="main">
    



    
            {% highlight javascript %}
            var radic = require('../'),
    _ = require('lodash'),
    path = require('path'),
    sh = require('../sh'),
    bin = require('../binwraps'),
    util = require('../util');
/**
 * @param {cli} cli
 */
module.exports = function (cli) {

    cli.command('system')
        .description('Shows system info')
        .usage('radic version minor', 'shows version')
        .method(function (cmd) {
            var disk = require('disk'),
                Monitor = require('monitor'),
                pm2 = require('pm2');

            var storage = {};


            // Physical disk devicesmap
            storage.devs = {};
            sh.execSync("lsblk | grep disk | awk '{print $1}'").stdout.split('\n').forEach(function(diskName){
                        if(diskName.length &lt; 1) return;
                        var dev = '/dev/' + diskName;
                        try {
                            var diskData = disk.load(dev);
                            storage.devs[dev] = diskData;
                        }
                        catch(e){
                            cli.log.warn('could not load ' + dev + ': ' + e.message);
                        }
                        finally {
                            cli.log.debug('loaded ' + dev + ' information');
                            //util.log(dev, diskData);
                        }
            });
            cli.log('Found ' + _.toArray(storage.devs).length + ' physical disk devices');

            // Virtual Groups
            storage.vgs = {};
            var tmpVgs;
            sh.execSync("sudo lvm vgs  | tr -s ' ' | cut -d ' ' -f 1,2,3,4,5,6,7,8 --output-delimiter='|'").stdout.split('\n').forEach(function(vgLine, i){
                if(i === 0) return;
                var vgd = vgLine.replace('|', '').split('|');
                if(vgd.length &lt; 2) return;

                storage.vgs[vgd[0]] = {
                    name: vgd[0],
                    physicalVolumes: vgd[1],
                    logicalVolumes: vgd[2],
                    sn: vgd[3],
                    attributes: vgd[4],
                    size: vgd[5],
                    free: vgd[6]
                }
            });
            // Logical Volumes
            storage.lvms = {};
            sh.execSync("sudo lvdisplay | grep 'LV Path' | awk '{print $3}'").stdout.split('\n').forEach(function(lvPath){
                if(lvPath.length &lt; 1) return;
                function lvi(colName, colNum) {
                    return sh.execSync("sudo lvdisplay " + lvPath + " | grep '" + colName + "' | awk '{print $" + colNum + "}'").stdout.replace(/\n/, '');
                }
                storage.lvms[lvPath] = {
                    path: lvi('LV Path', 3),
                    name: lvi('LV Name', 3),
                    vg: lvi('VG Name', 3),
                    uuid: lvi('LV UUID', 3),
                    writeAccess: lvi('LV Write Access', 4),
                    hostTime: lvi('LV Creation host, time', 5),
                    status: lvi('LV Status', 3),
                    size: lvi('LV Size', 3)
                };
            });
            cli.log('Found ' + _.toArray(storage.lvms).length + ' logical volumes devices accros ' + _.toArray(storage.vgs).length + ' virtual groups');
            console.log(storage);


        });


}

            {% endhighlight %}





</div>
