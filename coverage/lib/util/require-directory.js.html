---
layout: page
title: Node Radic
minify_content: false
navigation:
  - name: Home
    link: /
    icon: fa fa-home
  - name: Overview
    link: /node-radic
    icon: fa fa-dashboard
  - name: Coverage
    link: /node-radic/coverage
    icon: fa fa-code
  - name: Tutorials
    link: /node-radic/tutorials
    icon: fa fa-info
  - name: Modules
    link: "#"
    icon: fa fa-mortar-board
    children:
      - name: radic
        link: /node-radic/module-radic.html
  - name: Classes
    link: "#"
    icon: fa fa-mortar-board
    children:
      - name: Config
        link: /node-radic/Config.html
      - name: DB
        link: /node-radic/DB.html
      - name: Model
        link: /node-radic/Model.html
      - name: Table
        link: /node-radic/Table.html
  - name: Namespaces
    link: "#"
    icon: fa fa-mortar-board
    children:
      - name: binwraps
        link: /node-radic/binwraps.html
      - name: cli
        link: /node-radic/cli.html
      - name: git
        link: /node-radic/git.html
      - name: net
        link: /node-radic/net.html
      - name: sh
        link: /node-radic/sh.html
      - name: util
        link: /node-radic/util.html

---
<style>

    div.coverage-header, div.coverage-footer {
        background: #eee;
        padding: 1em;
    }
    div.coverage-header {
        border-bottom: 1px solid #666;
        width: 100%;
    }
    div.coverage-header h1 {
        font-size: 22px;
    }
    div.coverage-footer {
        border-top: 1px solid #666;
    }

    div.meta {
        font-size: 90%;
        text-align: center;
    }

    pre {
        font-family: Consolas, Menlo, Monaco, monospace;
        margin: 0;
        padding: 0;
        line-height: 14px;
        font-size: 14px;
        -moz-tab-size: 2;
        -o-tab-size:  2;
        tab-size: 2;
    }

    div.path { font-size: 110%; }
    div.path a:link, div.path a:visited { color: #000; }
    table.coverage { border-collapse: collapse; margin:0; padding: 0 }

    table.coverage td {
        margin: 0;
        padding: 0;
        color: #111;
        vertical-align: top;
    }
    table.coverage td.line-count {
        width: 50px;
        text-align: right;
        padding-right: 5px;
    }
    table.coverage td.line-coverage {
        color: #777 !important;
        text-align: right;
        border-left: 1px solid #666;
        border-right: 1px solid #666;
    }

    table.coverage td.text {
    }

    table.coverage td span.cline-any {
        display: inline-block;
        padding: 0 5px;
        width: 40px;
    }
    table.coverage td span.cline-neutral {
        background: #eee;
    }
    table.coverage td span.cline-yes {
        background: #b5d592;
        color: #999;
    }
    table.coverage td span.cline-no {
        background: #fc8c84;
    }

    .cstat-yes { color: #111; }
    .cstat-no { background: #fc8c84; color: #111; }
    .fstat-no { background: #ffc520; color: #111 !important; }
    .cbranch-no { background:  yellow !important; color: #111; }

    .cstat-skip { background: #ddd; color: #111; }
    .fstat-skip { background: #ddd; color: #111 !important; }
    .cbranch-skip { background: #ddd !important; color: #111; }

    .missing-if-branch {
        display: inline-block;
        margin-right: 10px;
        position: relative;
        padding: 0 4px;
        background: black;
        color: yellow;
    }

    .skip-if-branch {
        display: none;
        margin-right: 10px;
        position: relative;
        padding: 0 4px;
        background: #ccc;
        color: white;
    }

    .missing-if-branch .typ, .skip-if-branch .typ {
        color: inherit !important;
    }

    .entity, .metric { font-weight: bold; }
    .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
    .metric small { font-size: 80%; font-weight: normal; color: #666; }

    div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
    div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
    div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
    div.coverage-summary th.file { border-right: none !important; }
    div.coverage-summary th.pic { border-left: none !important; text-align: right; }
    div.coverage-summary th.pct { border-right: none !important; }
    div.coverage-summary th.abs { border-left: none !important; text-align: right; }
    div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
    div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
    div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
    div.coverage-summary td.pic { min-width: 120px !important;  }
    div.coverage-summary a:link { text-decoration: none; color: #000; }
    div.coverage-summary a:visited { text-decoration: none; color: #333; }
    div.coverage-summary a:hover { text-decoration: underline; }
    div.coverage-summary tfoot td { border-top: 1px solid #666; }

    div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
        height: 10px;
        width: 7px;
        display: inline-block;
        margin-left: 0.5em;
    }
    div.coverage-summary .yui3-datatable-sort-indicator {
        background: url("https://yui-s.yahooapis.com/3.6.0/build/datatable-sort/assets/skins/sam/sort-arrow-sprite.png") no-repeat scroll 0 0 transparent;
    }
    div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
        background-position: 0 -20px;
    }
    div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
        background-position: 0 -10px;
    }

    .high { background: #b5d592 !important; }
    .medium { background: #ffe87c !important; }
    .low { background: #fc8c84 !important; }

    span.cover-fill, span.cover-empty {
        display:inline-block;
        border:1px solid #444;
        background: white;
        height: 12px;
    }
    span.cover-fill {
        background: #ccc;
        border-right: 1px solid #444;
    }
    span.cover-empty {
        background: white;
        border: none;
    }
    span.cover-full {
        /*border-right: none !important;*/
    }
    pre.prettyprint {
        border: none !important;
        padding: 0 !important;
        margin: 0 !important;
    }
    .com { color: #999 !important; }
    .ignore-none { color: #999; font-weight: normal; }

</style>
    <link rel="stylesheet" href="../../prettify.css">
<div class="coverage-header low">
    <div>
        Statements: <span class="metric">12.82% <small>(5 / 39)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">0% <small>(0 / 43)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">16.67% <small>(1 / 6)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">12.82% <small>(5 / 39)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </div>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">lib/util/</a> &#187; require-directory.js</div>
</div>
<div class="coverage-body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109</td><td class="line-coverage"><span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">(function () {
    'use strict';
&nbsp;
    var _ = require('lodash'),
        fs = require('fs'),
        join = require('path').join,
        resolve = require('path').resolve,
        dirname = require('path').dirname,
        defaultOptions = {
            extensions: ['js', 'json', 'coffee'],
            recurse: true,
            rename: <span class="fstat-no" title="function not covered" >function (name) {</span>
<span class="cstat-no" title="statement not covered" >                return name;</span>
            },
            visit: <span class="fstat-no" title="function not covered" >function (obj) {</span>
<span class="cstat-no" title="statement not covered" >                return obj;</span>
            }
        };
&nbsp;
&nbsp;
    /**
     * @memberOf util
     * @param m
     * @param path
     * @param options
     * @returns {{}}
     */
<span class="fstat-no" title="function not covered" >    function requireDirectory(m, path, options) {</span>
<span class="cstat-no" title="statement not covered" >        var retval = {},</span>
            includeFile = null;
&nbsp;
        // path is optional
<span class="cstat-no" title="statement not covered" >        if (path &amp;&amp; !options &amp;&amp; !_.isString(path)) {</span>
<span class="cstat-no" title="statement not covered" >            options = path;</span>
<span class="cstat-no" title="statement not covered" >            path = null;</span>
        }
&nbsp;
        // default options
<span class="cstat-no" title="statement not covered" >        options = _.defaults(options || {}, defaultOptions);</span>
&nbsp;
        // if no path was passed in, assume the equivelant of __dirname from caller
        // otherwise, resolve path relative to the equivalent of __dirname
<span class="cstat-no" title="statement not covered" >        if (!path) {</span>
<span class="cstat-no" title="statement not covered" >            path = dirname(m.filename);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            path = resolve(dirname(m.filename), path);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        includeFile = <span class="fstat-no" title="function not covered" >function (path, filename) {</span></span>
            // verify file has valid extension
<span class="cstat-no" title="statement not covered" >            if (!new RegExp('\\.(' + options.extensions.join('|') + ')$', 'i').test(filename)) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
&nbsp;
            // if options.include is a RegExp, evaluate it and make sure the path passes
<span class="cstat-no" title="statement not covered" >            if (options.include &amp;&amp; options.include instanceof RegExp &amp;&amp; !options.include.test(path)) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
&nbsp;
            // if options.include is a function, evaluate it and make sure the path passes
<span class="cstat-no" title="statement not covered" >            if (options.include &amp;&amp; _.isFunction(options.include) &amp;&amp; !options.include(path, filename)) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
&nbsp;
            // if options.exclude is a RegExp, evaluate it and make sure the path doesn't pass
<span class="cstat-no" title="statement not covered" >            if (options.exclude &amp;&amp; options.exclude instanceof RegExp &amp;&amp; options.exclude.test(path)) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
&nbsp;
            // if options.exclude is a function, evaluate it and make sure the path doesn't pass
<span class="cstat-no" title="statement not covered" >            if (options.exclude &amp;&amp; _.isFunction(options.exclude) &amp;&amp; options.exclude(path, filename)) {</span>
<span class="cstat-no" title="statement not covered" >                return false;</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            return true;</span>
        };
&nbsp;
        // get the path of each file in specified directory, append to current tree node, recurse
<span class="cstat-no" title="statement not covered" >        path = resolve(path);</span>
<span class="cstat-no" title="statement not covered" >        fs.readdirSync(path).forEach(<span class="fstat-no" title="function not covered" >function (filename) {</span></span>
<span class="cstat-no" title="statement not covered" >            var joined = join(path, filename),</span>
                files,
                key,
                obj;
<span class="cstat-no" title="statement not covered" >            if (fs.statSync(joined).isDirectory() &amp;&amp; options.recurse) {</span>
<span class="cstat-no" title="statement not covered" >                files = requireDirectory(m, joined, options); </span>// this node is a directory; recurse
<span class="cstat-no" title="statement not covered" >                if (Object.keys(files).length) { // exclude empty directories</span>
<span class="cstat-no" title="statement not covered" >                    retval[options.rename(filename, joined, filename)] = files;</span>
                }
            } else {
<span class="cstat-no" title="statement not covered" >                if (joined !== m.filename &amp;&amp; includeFile(joined, filename)) {</span>
<span class="cstat-no" title="statement not covered" >                    key = filename.substring(0, filename.lastIndexOf('.')); </span>// hash node key shouldn't include file extension
<span class="cstat-no" title="statement not covered" >                    obj = m.require(joined);</span>
<span class="cstat-no" title="statement not covered" >                    retval[options.rename(key, joined, filename)] = options.visit(obj, joined, filename) || obj;</span>
                }
            }
        });
<span class="cstat-no" title="statement not covered" >        return retval;</span>
    }
&nbsp;
    /**
     * @memberOf util
     * @type {requireDirectory}
     */
    module.exports = requireDirectory;
    module.exports.defaults = defaultOptions;
&nbsp;
}());
&nbsp;</pre></td></tr>
</table></pre>
</div>
    <script src="../../prettify.js"></script>

<script src="https://yui-s.yahooapis.com/3.6.0/build/yui/yui-min.js"></script>
<script>

    YUI().use('datatable', function (Y) {

        var formatters = {
          pct: function (o) {
              o.className += o.record.get('classes')[o.column.key];
              try {
                  return o.value.toFixed(2) + '%';
              } catch (ex) { return o.value + '%'; }
          },
          html: function (o) {
              o.className += o.record.get('classes')[o.column.key];
              return o.record.get(o.column.key + '_html');
          }
        },
          defaultFormatter = function (o) {
              o.className += o.record.get('classes')[o.column.key];
              return o.value;
          };

        function getColumns(theadNode) {
            var colNodes = theadNode.all('tr th'),
                cols = [],
                col;
            colNodes.each(function (colNode) {
                col = {
                    key: colNode.getAttribute('data-col'),
                    label: colNode.get('innerHTML') || ' ',
                    sortable: !colNode.getAttribute('data-nosort'),
                    className: colNode.getAttribute('class'),
                    type: colNode.getAttribute('data-type'),
                    allowHTML: colNode.getAttribute('data-html') === 'true' || colNode.getAttribute('data-fmt') === 'html'
                };
                col.formatter = formatters[colNode.getAttribute('data-fmt')] || defaultFormatter;
                cols.push(col);
            });
            return cols;
        }

        function getRowData(trNode, cols) {
            var tdNodes = trNode.all('td'),
                    i,
                    row = { classes: {} },
                    node,
                    name;
            for (i = 0; i < cols.length; i += 1) {
                name = cols[i].key;
                node = tdNodes.item(i);
                row[name] = node.getAttribute('data-value') || node.get('innerHTML');
                row[name + '_html'] = node.get('innerHTML');
                row.classes[name] = node.getAttribute('class');
                //Y.log('Name: ' + name + '; Value: ' + row[name]);
                if (cols[i].type === 'number') { row[name] = row[name] * 1; }
            }
            //Y.log(row);
            return row;
        }

        function getData(tbodyNode, cols) {
            var data = [];
            tbodyNode.all('tr').each(function (trNode) {
                data.push(getRowData(trNode, cols));
            });
            return data;
        }

        function replaceTable(node) {
            if (!node) { return; }
            var cols = getColumns(node.one('thead')),
                data = getData(node.one('tbody'), cols),
                table,
                parent = node.get('parentNode');

            table = new Y.DataTable({
                columns: cols,
                data: data,
                sortBy: 'file'
            });
            parent.set('innerHTML', '');
            table.render(parent);
        }

        Y.on('domready', function () {
            replaceTable(Y.one('div.coverage-summary table'));
            if (typeof prettyPrint === 'function') {
                prettyPrint();
            }
        });
    });
</script>
